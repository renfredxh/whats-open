{% extends "admin/base_site.html" %}

{% block extrahead %}
{{ block.super }}
<!-- neither jQuery proper nor Django's version is loaded by default on this page -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
{% endblock %}

{% block extrastyle %}
{{ block.super }}
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
{% endblock %}

{% block title %}
Set main schedule for multiple facilities
{{ block.super }}
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="{% url 'admin:index' %}">Home</a>
  &rsaquo; <a href="{% url 'admin:app_list' 'api' %}">Api</a>
  &rsaquo; <a href="{% url 'admin:api_facility_changelist' %}">Facilities</a>
  &rsaquo; Set main schedule for multiple facilities
</div>
{% endblock %}

{% block content %}
<form action="" method="post">
  {% csrf_token %}
  <label for="id_label_single">
    Schedule
      <select name="schedule" class="select2-basic-single" id="id_label_single">
      {% for schedule in schedules %}
        <option value={{ schedule.pk }} >{{ schedule }}</option>
      {% endfor %}
      </select>
  </label>

  <p>Set this as the main schedule for all of these facilities?</p>
  <ul>
  {% for facility in facilities %}
    <li>{{ facility.facility_name }}</li>
    <input type="hidden" name="_selected_action" value="{{ facility.pk }}" />
  {% endfor %}
  </ul>
<input type="hidden" name="action" value="assign_bulk_schedules" />
<input type="submit" name="bulk_schedule" value="Yes, I'm sure" />
</form>

<script>
/**
 Django's admin inferface uses this library for its new autocompletion selects

 Unfortunately, use of that specific widget and the associated support attributes
 are limited to admin.ModelAdmin change views

 See
 https://docs.djangoproject.com/en/2.0/ref/contrib/admin/#django.contrib.admin.ModelAdmin.autocomplete_fields
 https://docs.djangoproject.com/en/2.0/ref/contrib/admin/#reversing-admin-urls
 for more information
**/

$(document).ready(function() {
    $('.select2-basic-single').select2({
    });
});
</script>
{% endblock %}
